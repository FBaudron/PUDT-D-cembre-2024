---
title: "Rapport d'enquête PUDT"
author: "Frédéric Baudron, François Gatignol, Julie Murel, Lambert Moundzeo"
date: "6/12/2024"
output: word_document
---



```{r setup, include=FALSE}

knitr::opts_chunk$set(fig.width = 9, fig.height = 9,fig.path = 'Figures enquêtes/',
                      echo = FALSE, warning = FALSE, message = FALSE)

```


```{r tot}

library(openxlsx)
library(terra)
library(geodata)
library(dplyr)
library(knitr)
library(ggplot2)
library(ggdist)
library(ggthemes)
library(ggspatial)
library(tidyterra)
library(sf)
library(gtsummary)
library(kableExtra)
library(tidyr)
library(data.table)
library(RColorBrewer)


setwd("D:\\Mes Donnees\\1. Cirad\\PUDT\\Enquête\\")


loc = read.xlsx("Input_files\\1.1. Localisation avec types esquisse.xlsx", sheet = 1)
enq = read.xlsx("Input_files\\2. Enquêté.xlsx", sheet = 1)
mbr = read.xlsx("Input_files\\3.1. Membres du ménage.xlsx", sheet = 1)
chf = read.xlsx("Input_files\\3.2. Chef de famille.xlsx", sheet = 1)
hst = read.xlsx("Input_files\\4. Histoire.xlsx", sheet = 1)
sec = read.xlsx("Input_files\\5. Sécurité alimentaire.xlsx", sheet = 1)
agr = read.xlsx("Input_files\\6.1. Agriculture générale.xlsx", sheet = 1)
chp = read.xlsx("Input_files\\6.2. Champs.xlsx", sheet = 1)
div = read.xlsx("Input_files\\6.3. Diversité cultures.xlsx", sheet = 1)
man = read.xlsx("Input_files\\6.4.1. Manioc.xlsx", sheet = 1)
mai = read.xlsx("Input_files\\6.4.2. Maïs.xlsx", sheet = 1)
soj = read.xlsx("Input_files\\6.4.3. Soja.xlsx", sheet = 1)
ara = read.xlsx("Input_files\\6.4.4. Arachide.xlsx", sheet = 1)
saf = read.xlsx("Input_files\\6.4.5. Safou.xlsx", sheet = 1)
cac = read.xlsx("Input_files\\6.4.6. Cacao.xlsx", sheet = 1)
caf = read.xlsx("Input_files\\6.4.7. Café.xlsx", sheet = 1)
pla = read.xlsx("Input_files\\6.4.8. Plantain.xlsx", sheet = 1)
pal = read.xlsx("Input_files\\6.4.9. Palmier.xlsx", sheet = 1)
ori = read.xlsx("Input_files\\6.5. Orientation.xlsx", sheet = 1)
pre = read.xlsx("Input_files\\6.6. Précédent et status.xlsx", sheet = 1)
bet = read.xlsx("Input_files\\6.7.1. Production bétail.xlsx", sheet = 1)
psn = read.xlsx("Input_files\\6.7.2. Production poissons.xlsx", sheet = 1)
res = read.xlsx("Input_files\\6.8. Ressources naturelles.xlsx", sheet = 1)
rev = read.xlsx("Input_files\\7.1. Revenus principaux.xlsx", sheet = 1)
rvt = read.xlsx("Input_files\\7.2. Revenus totaux.xlsx", sheet = 1)
fct = read.xlsx("Input_files\\8.1. Force de travail.xlsx", sheet = 1)
dyn = read.xlsx("Input_files\\8.2. Dynamiques de l'exploitation.xlsx", sheet = 1)
eqt = read.xlsx("Input_files\\8.3 Equipement.xlsx", sheet = 1)
acc = read.xlsx("Input_files\\9.1. Accompagnement.xlsx", sheet = 1)
ctr = read.xlsx("Input_files\\9.2. Contrats.xlsx", sheet = 1)
mch = read.xlsx("Input_files\\9.3. Distance au marché.xlsx", sheet = 1)
psp = read.xlsx("Input_files\\10. Perspectives.xlsx", sheet = 1)

cog0 = gadm(country = 'COG', level = 0, path = 'D:\\Mes Donnees\\1. Cirad\\PUDT\\Geo\\input-data\\admin-regions')
cog1 = gadm(country = 'COG', level = 1, path = 'D:\\Mes Donnees\\1. Cirad\\PUDT\\Geo\\input-data\\admin-regions')
cog2 = gadm(country = 'COG', level = 2, path = 'D:\\Mes Donnees\\1. Cirad\\PUDT\\Geo\\input-data\\admin-regions')

elevation = geodata::elevation_30s("COG", path = 'D:\\Mes Donnees\\1. Cirad\\PUDT\\Geo\\input-data\\elevation')


```


# 1. Introduction

Ce apport synthétise les principaux résultats d'une enquête de `r nrow(loc)` ménages conduite entre le 23 juillet et le 20 septembre 2024.

Cette enquête visait l'agriculture familiale du COngo et avait pour but de:
- Caractériser la diversité des exploitations familiales 
- Comprendre les interactions agriculture-forêt
- Cerner les contraintes et opportunités et estimer les niveaux de production autour de 7 cultures cibles: manioc, mais, soja, arachide, safou, palmier, et plantain.

Les localités (villages) ont été utilisées comme premier degré déchantillonnage, puis dans chaque localité sélectionnées, 10 exploitations ont été sélectionnées de façon aléatoire (deuxième degré d'échantionnage). Dans un premier temps, 100 localités ont été sélectionnées pas échantionnage aléatoire stratifié, en utilisant la végétation comme strate (voire rapport de mission de Boulakia, Baudron, Gatignol et Murel de 2024 pour plus de détails). Cette échantillon a ensuite été complété par d'autres villages représentatifs de la diversité des départements, tel que révélé par les zonages à dire d'acteurs (ZADA). De ce processus est résulté un échantillon représentatif et raisonné de 151 villages.


```{r tab1, tab.cap = "Nombre de ménages enquêtés par département"}

kable(loc %>%
        group_by(departement)%>%
        tally(),
      col.names = c("Département", "Nombre de ménages"))

```


```{r fig1, fig.width = 12, fig.height = 12, fig.cap = "Localisation des ménages enquêtés"}

loc_sf = st_as_sf(loc, coords = c("longitude", "latitude"), crs ="+proj=longlat + datum = WGS84 + no_defs")
loc_sf = as(loc_sf, "Spatial")
loc_sf = vect(loc_sf)
loc_sf = project(loc_sf, "EPSG:4326")

elevation = terra::crop(elevation, cog0)
elevation = terra::mask(elevation, cog0)

elevation_df = as.data.frame(elevation, xy = TRUE)

ggplot() + theme_bw() +
  geom_raster(data = na.omit(elevation_df), aes(x = x, y = y, fill = COG_elv_msk)) +
  geom_spatvector(data = cog1, fill = NA, linewidth = 1, color = "black") +
  geom_spatvector(data = loc_sf, shape = 1, color = "#225EA8", alpha = 1, size = 2) +
  scale_fill_distiller(palette = "RdYlGn") +
  labs(fill = "Altitude (m.s.n.m.)") +
  theme(plot.title = element_blank(),
        axis.title = element_blank(),
        axis.text.y = element_text(angle = 90, hjust = 0.5, size = 12),
        axis.text.x = element_text(size = 12),
        legend.title = element_text(size = 14),
        legend.text = element_text(size = 12),
        legend.position = "right",
        plot.margin = margin(10, 10, 10, 10)) +
  annotation_scale(location = "bl", width_hint = 0.5, height = unit(0.25, "cm"), 
                   text_cex = 1, pad_x = unit(0.15, "cm"), pad_y = unit(0.15, "cm")) +
  annotation_north_arrow(location = "tl", which_north = "true", 
                         height = unit(1, "cm"), width = unit(1, "cm"),
                         pad_x = unit(0.15, "cm"), pad_y = unit(0.15, "cm"),
                         style = north_arrow_fancy_orienteering(text_size = 10))

```


# 2. Caractéristiques de l'enquêté et du ménage

```{r tab2, tab.cap = "Langues parlées par l'enquêté"}

enq = merge(enq, loc[, c(1:2)], by = "id")

enq[, c(5:12, 14:20, 24)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1
    )%>%
  add_overall()%>%
  modify_header(label = "**Langue**")%>%
  as_kable()

```


```{r tab3, tab.cap = "Caractéristiques du chef de famille"}

chf = merge(chf, hst[, c(1:2)], by = "id")
chf = merge(chf, loc[, c(1:2)], by = "id")

chf$education_chef_fam = factor(chf$education_chef_fam, levels = c("Aucun", "Education primaire", "Collège", "Lycée", "Enseignement supérieur"))

chf[, c(2:6)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(genre_chef_fam ~ "Genre du chef de ménage",
                 age_chef_fam ~ "Age du chef de ménage",
                 education_chef_fam ~ "Niveau d'éducation du chef de ménage",
                 indigene ~ "Originaire du village")
  )%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


```{r tab4, tab.cap = "Raisons pour lesquelles les allochtones ont quitté leur village"}

hst = merge(hst, loc[, c(1:2)], by = "id")

hst[, c(4:9, 23)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(insecurite ~ "Insécurité",
                 etudes ~ "Etudes hors du village",
                 travail ~ "Travail hors du village",
                 raisons_familiales ~ "Raisons familiales",
                 raisons_economiques ~ "Raisons économiques",
                 quitte_village_autre ~ "Autre"))%>%
  add_overall()%>%
  modify_header(label = "**Raison**")%>%
  as_kable()

```


```{r tab5, tab.cap = "Principales raisons pour laquelle les allochtones ont décidé de s'installer dans le village dans lequel ils habitent actuellement"}

hst[, c(13:14, 16:21, 23)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(terre_natale ~ "Terre natale",
                 terre_fertile ~ "Terre plus fertile",
                 zone_moins_enclavee ~ "Zone moins enclavée",
                 acces_terre_facile ~ "Accès à la terre plus facile",
                 emploi_terres ~ "Venu pour trouver de l'emploi, et ai pu trouver de la terre",
                 conflit_village_natal ~ "Conflit dans village natal",
                 proche_conjoint ~ "Rejoint un proche/un(e) conjoint(e)",
                 installation_autre ~ "Autre")
    )%>%
  add_overall()%>%
  modify_header(label = "**Raison**")%>%
  as_kable()

```


```{r fig2, fig.width = 9, fig.height = 6, fig.cap = "Composition du ménage (les exploitations ont été classées par taille de ménage décroissante, et une moyenne moyenne mobile a été appliquée à des sous-ensembles de 20 exploitations pour lisser les courbes et faciliter leur interprétation. La ligne en pointillés représente la taille moyenne du foyer pour l'échantillon total)"}

mbr$classe = ifelse(mbr$age < 18, "adultes", "mineurs")
mbr$classe = paste(mbr$genre, mbr$classe, sep="s ")

mbr_moy = mbr %>%
  group_by(id, classe) %>%
  tally()

mbr_moy = spread(mbr_moy, classe, n)

mbr_moy$`Femmes adultes`[is.na(mbr_moy$`Femmes adultes`)] = 0
mbr_moy$`Femmes mineurs`[is.na(mbr_moy$`Femmes mineurs`)] = 0
mbr_moy$`Hommes adultes`[is.na(mbr_moy$`Hommes adultes`)] = 0
mbr_moy$`Hommes mineurs`[is.na(mbr_moy$`Hommes mineurs`)] = 0

mbr_moy = merge(mbr_moy, enq[, c(1, 23)])

mbr_moy$taille_famille = mbr_moy$taille_famille - mbr_moy$`Femmes adultes` - mbr_moy$`Femmes mineurs` -
  mbr_moy$`Hommes adultes` - mbr_moy$`Hommes mineurs`

mbr_moy$taille_famille = ifelse(mbr_moy$taille_famille < 0, 0, mbr_moy$taille_famille)

names(mbr_moy) = c("id", "Femmes", "Filles", "Hommes", "Garçons", "Enfants")

mbr_moy$somme = rowSums(mbr_moy[c(2:6)])
mbr_moy = mbr_moy[order(-mbr_moy$somme),]
mbr_moy$id2 = 1:nrow(mbr_moy)
taille_moyenne = mean(mbr_moy$somme)

foyer = mbr_moy

mbr_moy$Femmes = frollmean(mbr_moy$Femmes, 20)
mbr_moy$Filles = frollmean(mbr_moy$Filles, 20)
mbr_moy$Hommes = frollmean(mbr_moy$Hommes, 20)
mbr_moy$Garçons = frollmean(mbr_moy$Garçons, 20)
mbr_moy$Enfants = frollmean(mbr_moy$Enfants, 20)

mbr_moy = gather(mbr_moy, classe, n, "Femmes":"Enfants")

mbr_moy$classe = factor(mbr_moy$classe, levels = c("Hommes", "Femmes", "Garçons", "Filles", "Enfants"))

mbr_moy %>%
  ggplot(aes(x = id2, y = n, fill = as.factor(classe))) +
  geom_bar(stat = 'identity', width = 1, position = position_stack(reverse = TRUE)) +
  geom_hline(yintercept = taille_moyenne, linetype = "dashed", color = "black", linewidth = 1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  scale_fill_brewer(palette = "YlGnBu", direction = 1) +
  xlab("Exploitations") + ylab("Nombre de membres du foyer") + 
  theme_bw() +
  theme(plot.title = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 12,  face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold", margin = margin(10, 0, 0, 0)),
        axis.title.y = element_text(size = 14, face = "bold", margin = margin(0, 10, 0, 0)),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(colour = "black", fill = "white"),
        legend.title = element_blank(),
        legend.text = element_text(size = 12),
        legend.position = c(0.9, 0.9), legend.justification = c(0.9, 0.9),
        plot.margin = margin(10, 10, 10, 10)) 

```


```{r tab6, tab.cap = "Caractéristiques du ménage"}

foyer = merge(foyer[, c(1:7)], loc[, c(1:2)], by = "id")

names(foyer)[7] = "Taille du ménage"

foyer = foyer[, c(1, 7, 4, 2, 5, 3, 6, 8)]

foyer[, -c(1)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
   #  label = list(taille_famille ~ "Taille du ménage"),
    type = list(Hommes ~ "continuous",
                Femmes ~ "continuous",
                Garçons ~ "continuous",
                Filles ~ "continuous")
  )%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


```{r fig3, fig.width = 8, fig.height = 9, fig.cap = "Taille du ménage par département"}

ggplot(foyer, aes(x = departement, y = `Taille du ménage`, fill = departement)) + 
  ggdist::stat_halfeye(adjust = 0.6, width = 0.4, .width = 0, justification = -.4, point_colour = NA, slab_colour = "black", slab_linewidth = 0.5, alpha = 0.8) + 
  geom_point(shape = 21, size = 2, alpha = 0.6, position = position_jitter(seed = 1, width = 0.1)) +
  geom_boxplot(width = .2, outlier.shape = NA, alpha = 0.4) +
  scale_fill_manual(values = c("white", "#FFFFD9", "#EDF8B1", "#C7E9B4", "#7FCDBB", "#41B6C4", "#1D91C0", "#225EA8", "#253494", "#081D58")) +
  ylab("Taille du ménage") +
  theme_few() + coord_flip() +
  theme(legend.position = "none",
        axis.text.x = element_text(size = 12, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold", margin = margin(10, 0, 0, 0)),
        axis.title.y = element_blank())

```

# 3. Sécurité alimentaire

```{r tab7, tab.cap = "Sécurité alimentaire"}

sec = merge(sec[, c(1:3)], loc[, c(1:2)], by = "id")

sec[, -c(1)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(nb_repas ~ "Nombre moyen de repas par jours",
                 securite_alim ~ "Sécurité alimentaire (pas de nécessité de réduire le nombre de repas)")
  )%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


# 4. Agriculture

## 4.1. Général

```{r tab8, tab.cap = "Structure des exploitations"}

agr = merge(agr, div, by = "id")
agr = merge(agr, loc[, c(1:2)], by = "id")
agr = merge(agr, ori[, c(1, 15)], by = "id")
agr = merge(agr, pre[, c(1:3, 5)], by = "id")

agr$surface_louee = ifelse(agr$surface_louee > 0, 1, 0)
agr$jachere = ifelse(agr$jachere > 0, 1, 0)

chp = chp[, c(1, 47:50, 53:68, 70:76, 78)]

chp$fumier_lisier = as.numeric(chp$fumier_lisier == "Oui")
chp$voleurs = as.numeric(chp$voleurs == "Oui")

chp$bovins[is.na(chp$bovins)] = 0
chp$chevres[is.na(chp$chevres)] = 0
chp$moutons[is.na(chp$moutons)] = 0
chp$elephants[is.na(chp$elephants)] = 0
chp$buffles[is.na(chp$buffles)] = 0
chp$hippopotames[is.na(chp$hippopotames)] = 0
chp$cochons_sauvages[is.na(chp$cochons_sauvages)] = 0
chp$antilopes[is.na(chp$antilopes)] = 0
chp$grands_singes[is.na(chp$grands_singes)] = 0
chp$petits_singes[is.na(chp$petits_singes)] = 0
chp$rongeurs[is.na(chp$rongeurs)] = 0
chp$oiseaux[is.na(chp$oiseaux)] = 0
chp$mille_pattes[is.na(chp$mille_pattes)] = 0
chp$criquets[is.na(chp$criquets)] = 0
chp$chenilles[is.na(chp$chenilles)] = 0
chp$secheresse[is.na(chp$secheresse)] = 0
chp$chaleur[is.na(chp$chaleur)] = 0
chp$secheresse[is.na(chp$secheresse)] = 0
chp$inondation[is.na(chp$inondation)] = 0
chp$incendie[is.na(chp$incendie)] = 0
chp$precipitation[is.na(chp$precipitation)] = 0
chp$vent[is.na(chp$vent)] = 0
chp$glissement[is.na(chp$glissement)] = 0

chp = aggregate(. ~ id, FUN = sum, na.rm = TRUE, data = chp)

chp[, c(2:29)] = ifelse(chp[, c(2:29)] > 0, 1, 0)

agr = merge(agr, chp, by = "id")

agr[, c(2:4, 6, 9:10, 43:54)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    type = list(nb_systemes ~ "continuous"),
    label = list(nb_champs ~ "Nombre de champs",
                 nb_systemes ~ "Nombre de systèmes de culture",
                 jardin ~ "Présence d'un jardin",
                 verger ~ "Présence d'un verger",
                 jachere ~ "Terres en jachère",
                 surface_louee ~ "Terres en location",
                 cultivated_area ~ "Superficie cultivée (ha)",
                 diversite_annual ~ "Diversité d'annuelles",
                 diversite_perenial ~ "Diversité de pérennes",
                 diversite_total ~ "Diversité totale",
                 orientation ~ "Orientation vers le marché (vente de plus de 50%)",
                 previous_vegetation ~ "Végétation précédente",
                 fallow_duration ~ "Durée de jachère",
                 statut_champ ~ "Statut foncier des terres cultivées",
                 fumier_lisier ~ "Utilisation de fumier/lisier",
                 qte_engrais ~ "Utilisation d'engrais minéraux",
                 nb_pesticide ~ "Utilisation de pesticides"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


```{r fig4, fig.width = 8, fig.height = 9, fig.cap = "Surfaces cultivées"}

ggplot(agr, aes(x = departement, y = cultivated_area, fill = departement)) + 
  ggdist::stat_halfeye(adjust = 0.6, width = 0.4, .width = 0, justification = -.4, point_colour = NA, slab_colour = "black", slab_linewidth = 0.5, alpha = 0.8) + 
  geom_point(shape = 21, size = 2, alpha = 0.6, position = position_jitter(seed = 1, width = 0.1)) +
  geom_boxplot(width = .2, outlier.shape = NA, alpha = 0.4) +
  scale_fill_manual(values = c("white", "#FFFFD9", "#EDF8B1", "#C7E9B4", "#7FCDBB", "#41B6C4", "#1D91C0", "#225EA8", "#253494", "#081D58")) +
  ylab("Surfaces cultivées") +
  theme_few() + coord_flip() +
  theme(legend.position = "none",
        axis.text.x = element_text(size = 12, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold", margin = margin(10, 0, 0, 0)),
        axis.title.y = element_blank())

```


```{r fig5, fig.width = 8, fig.height = 9, fig.cap = "Diversité de cultures annuelles et pérennes"}

ggplot(agr, aes(x = departement, y = diversite_total, fill = departement)) + 
  ggdist::stat_halfeye(adjust = 0.6, width = 0.4, .width = 0, justification = -.4, point_colour = NA, slab_colour = "black", slab_linewidth = 0.5, alpha = 0.8) + 
  geom_point(shape = 21, size = 2, alpha = 0.6, position = position_jitter(seed = 1, width = 0.1)) +
  geom_boxplot(width = .2, outlier.shape = NA, alpha = 0.4) +
  scale_fill_manual(values = c("white", "#FFFFD9", "#EDF8B1", "#C7E9B4", "#7FCDBB", "#41B6C4", "#1D91C0", "#225EA8", "#253494", "#081D58")) +
  ylab("Nombre de cultures") +
  theme_few() + coord_flip() +
  theme(legend.position = "none",
        axis.text.x = element_text(size = 12, face = "bold"),
        axis.text.y = element_text(size = 14, face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold", margin = margin(10, 0, 0, 0)),
        axis.title.y = element_blank())

```


```{r tab9, tab.cap = "Cultures présentes"}

agr[, c(11:16, 18:25, 27:42, 47)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(mais ~ "maïs",
             autres_tubercules ~ "autres tubercules",
             pois_dangole ~ "pois d'Angole",
             sesame ~ "sésame",
             legumes_feuilles ~ "légumes feuilles",
             legumes_fruits ~ "légumes fruits",
             canne_a_sucre ~ "canne à sucre",
             cafe ~ "café",
             autres_arbres_outside_fields ~ "autres arbres en dehors des parcelles",
             autres_arbres_fruitiers_inside_fields ~ "autres arbres fruitiers dans les parcelles",
             autres_arbres_nonfruitiers_inside_fields ~ "autres arbres non-fruitiers dans les parcelles")
    )%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


```{r tab10, tab.cap = "Dégats de culture"}

agr[, c(11:16, 18:25, 27:42, 47)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(mais ~ "maïs",
             autres_tubercules ~ "autres tubercules",
             pois_dangole ~ "pois d'Angole",
             sesame ~ "sésame",
             legumes_feuilles ~ "légumes feuilles",
             legumes_fruits ~ "légumes fruits",
             canne_a_sucre ~ "canne à sucre",
             cafe ~ "café",
             autres_arbres_outside_fields ~ "autres arbres en dehors des parcelles",
             autres_arbres_fruitiers_inside_fields ~ "autres arbres fruitiers dans les parcelles",
             autres_arbres_nonfruitiers_inside_fields ~ "autres arbres non-fruitiers dans les parcelles")
    )%>%
  add_overall()%>%
  as_kable()

```


## 4.2. Manioc

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(man)` produisent du manioc.

```{r tab11, tab.cap = "Production du manioc (les champs ne produisant pas de manioc ne sont pas inclus dans les calculs de productions moyennes, de revenus moyens et de rendements moyens)"}

man$materiel_transfo = ifelse(man$materiel_transfo == "Non", "Pas de matériel de transformation", man$materiel_transfo)

man$manioc_production = ifelse(man$manioc_production == 0, NA, man$manioc_production)
man$manioc_revenus = ifelse(man$manioc_production == 0, NA, man$manioc_revenus)
man$rend_manioc = ifelse(man$manioc_production == 0, NA, man$rend_manioc)

man$rend_manioc = ifelse(man$rend_manioc > 20000, NA, man$rend_manioc)

man[, c(2:10, 11, 13, 15:17, 19:20, 22:23, 66:69, 58)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(bout_autoprod ~ "boutures auto-produites",
             bout_voisin ~ "boutures provenant d'un voisin",
             bout_magasin ~ "boutures provenant d'un magasin",
             bout_pepiniere ~ "boutures provenant d'une pépinière",
             bout_projet ~ "boutures provenant d'une ONG/d'un projet",
             bout_prive ~ "boutures provenant d'un partenaire privé",
             bout_publique ~ "boutures provenant d'un partenaire publique",
             part_autoconso ~ "part de manioc autoconsommée (%)",
             part_vendue ~ "part de manioc vendue (%)",
             materiel_transfo ~ "materiel de transformation",
             moulin ~ "si moulin, status de ce moulin",
             chikwangue ~ "vente de manioc sous forme de chikwangue",
             cossettes ~ "vente de manioc sous forme de cossettes",
             roui ~ "vente de manioc sous forme de turbercules rouis",
             foufou_emiette ~ "vente de manioc sous forme de foufou émietté",
             tubercule_frais ~ "vente de manioc sous forme de tubercules frais",
             farine_foufou ~ "vente de manioc sous forme de farine de foufou",
             gari ~ "vente de manioc sous forme de gari",
             manioc_production ~ "production totale de manioc (kg turbercule sfrais eq./an)",
             manioc_revenus ~ "revenus totaux du manioc (XAF/an)",
             surf_manioc ~ "surface cultivée en manioc (ha)",
             rend_manioc ~ "rendement en manioc (kg tubercules frais eq./ha)"
    )
  )%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.3. Maïs

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(mai)` produisent du maïs.

```{r tab12, tab.cap = "Production du maïs (les champs ne produisant pas de maïs ne sont pas inclus dans les calculs de productions moyennes, de revenus moyens et de rendements moyens)"}

mai$mais_production = ifelse(mai$mais_production == 0, NA, mai$mais_production)
mai$mais_revenus = ifelse(mai$mais_revenus == 0, NA, mai$mais_revenus)
mai$rend_mais = ifelse(mai$rend_mais == 0, NA, mai$rend_mais)


mai[, c(2:6, 8:14, 16, 18, 42, 46:49)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(sem_autoprod ~ "semences auto-produites",
                 sem_voisin ~ "semences provenant d'un voisin",
                 sem_magasin ~ "semences provenant d'un magasin",
                 sem_pepiniere ~ "semences provenant d'une pépinière",
                 sem_projet ~ "semences provenant d'une ONG/d'un projet",
                 sem_publique ~ "semences provenant d'un partenaire publique",
                 part_autoconso ~ "part de maïs autoconsommée (%)",
                 part_vendue ~ "part de maïs vendue (%)",
                 part_alim_animale ~ "part de maïs utilisée pour l'alimentation animale (%)",
                 statut_broyeur ~ "si broyeur, status de ce broyeur",
                 epis ~ "vente de maïs sous forme d'épis",
                 farine ~ "vente de maïs sous forme de farine",
                 grains ~ "vente de maïs sous forme de grains",
                 mais_production ~ "production totale de maïs (kg)",
                 mais_revenus ~ "revenus totaux du maïs (XAF/an)",
                 surf_mais ~ "surface cultivée en maïs (ha)",
                 rend_mais ~ "rendement en maïs (kg/ha)"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.4. Arachide

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(ara)` produisent de l'arachide.


```{r tab13, tab.cap = "Production d'arachide (les champs ne produisant pas d'arachide ne sont pas inclus dans les calculs de productions moyennes, de revenus moyens et de rendements moyens)"}

ara$arachide_production = ifelse(ara$arachide_production == 0, NA, ara$arachide_production)
ara$arachide_revenus = ifelse(ara$arachide_revenus == 0, NA, ara$arachide_revenus)
ara$rend_arachide = ifelse(ara$rend_arachide == 0, NA, ara$rend_arachide)

ara[, c(2:4, 6, 8:12, 15, 38, 42:45)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(sem_autoprod ~ "semences auto-produites",
                 sem_voisin ~ "semences provenant d'un voisin",
                 sem_magasin ~ "semences provenant d'un magasin",
                 sem_projet ~ "semences provenant d'une ONG/d'un projet",
                 sem_publique ~ "semences provenant d'un partenaire publique",
                 part_autoconso ~ "part d'arachide autoconsommée (%)",
                 part_vendue ~ "part d'arachide vendue (%)",
                 coques ~ "vente d'arachide sous forme de coques",
                 decortiquees ~ "vente d'arachide sous forme décortiquées",
                 pate ~ "vente d'arachide sous forme de pâte",
                 arachide_production ~ "production totale d'arachide (kg)",
                 arachide_revenus ~ "revenus totaux de l'arachide (XAF/an)",
                 surf_arachide ~ "surface cultivée en arachide (ha)",
                 rend_arachide ~ "rendement en arachide (kg/ha)"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.5. Safou

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(saf)` produisent du safou.


```{r tab14, tab.cap = "Production de safou (les exploitations ne produisant pas de safou ne sont pas inclues dans les calculs de productions moyennes et  de revenus moyens)"}

saf$safou_production = ifelse(saf$safou_production == 0, NA, saf$safou_production)
saf$safou_revenus = ifelse(saf$safou_revenus == 0, NA, saf$safou_revenus)

saf[, c(2:12, 18, 21:22)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(plant_autoprod ~ "plants auto-produits",
                 plant_voisin ~ "plants provenant d'un voisin",
                 plant_magasin ~ "plants provenant d'un magasin",
                 plant_pepiniere ~ "plants provenant d'une pépinière",
                 plant_projet ~ "plants provenant d'une ONG/d'un projet",
                 plant_prive ~ "plants provenant d'un partenaire privé",
                 plant_publique ~ "plants provenant d'un partenaire publique",
                 age_max ~ "âge maximum des arbes",
                 age_min ~ "âge minimum des arbres",
                 part_autoconso ~ "part de safou autoconsommée (%)",
                 part_vendue ~ "part de safou vendue (%)",
                 safou_production ~ "production totale de safou (kg)",
                 safou_revenus ~ "revenus totaux du safou (XAF/an)"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.6. Cacao

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(cac)` produisent du cacao


```{r tab15, tab.cap = "Production de cacao"}

cac = merge(cac, loc[, c(1:2)], by = "id")

cac$nb_tailles = ifelse(cac$nb_tailles == "Pas de sarclage", "Pas de taille", cac$nb_tailles)

cac[, c(2:7, 9:12, 14:19, 23:24)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(plant_autoprod ~ "plants auto-produits",
                 plant_voisin ~ "plants provenant d'un voisin",
                 plant_magasin ~ "plants provenant d'un magasin",
                 plant_pepiniere ~ "plants provenant d'une pépinière",
                 plant_projet ~ "plants provenant d'une ONG/d'un projet",
                 plant_prive ~ "plants provenant d'un partenaire privé",
                 age_max ~ "âge maximum des arbes",
                 age_min ~ "âge minimum des arbres",
                 nb_tailles ~ "nombre de tailles",
                 volume_cacao ~ "volume de cacao produit (kg/an)",
                 lieu_vente_cacao ~ "lieu de vente du cacao",
                 cacao_revenus ~ "revenus totaux du cacao (XAF/an)",
                 vente_cacao_marche ~ "vente à des clients sur le marché",
                 vente_cacao_artisan ~ "vente à un transformateur/restaurateur",
                 vente_cacao_grossiste ~ "vente à une grossiste",
                 vente_cacao_indistriel ~ "vente à un groupe industriel",
                 vente_cacao_entrepreneur ~ "vente à un entrepreneur"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.7. Café

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(caf)` produisent du café


```{r tab16, tab.cap = "Production de café"}

caf = merge(caf, loc[, c(1:2)], by = "id")

caf[, c(2:3, 6, 9:11, 13:17, 22:23)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    type = list(age_min ~ "continuous",
                volume_cafe ~ "continuous"),
    label = list(plant_autoprod ~ "plants auto-produits",
                 plant_voisin ~ "plants provenant d'un voisin",
                 plant_projet ~ "plants provenant d'une ONG/d'un projet",
                 age_max ~ "âge maximum des arbes",
                 age_min ~ "âge minimum des arbres",
                 volume_cafe ~ "volume de café produit (kg/an)",
                 lieu_vente_cafe ~ "lieu de vente du café",
                 cafe_revenus ~ "revenus totaux du café (XAF/an)",
                 vente_cafe_marche ~ "vente à des clients sur le marché",
                 vente_cafe_artisan ~ "vente à un transformateur/restaurateur",
                 vente_cafe_grossiste ~ "vente à une grossiste",
                 vente_cafe_indistriel ~ "vente à un groupe industriel"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.8. Plantain

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(pla)` produisent du plantain


```{r tab17, tab.cap = "Production de plantain (les champs ne produisant pas de plantain ne sont pas inclus dans les calculs de productions moyennes, de revenus moyens et de rendements moyens)"}

pla$plantain_production = ifelse(pla$plantain_production == 0, NA, pla$plantain_production)
pla$plantain_revenus = ifelse(pla$plantain_revenus == 0, NA, pla$plantain_revenus)
pla$rend_plantain = ifelse(pla$rend_plantain == 0, NA, pla$rend_plantain)

pla[, c(2:3, 9, 12:15)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(part_autoconso ~ "part de plantain autoconsommée (%)",
                 part_vendue ~ "part de plantain vendue (%)",
                 plantain_production ~ "production totale de plantain (kg/an)",
                 plantain_revenus ~ "revenus totaux du plantain (XAF/an)",
                 surf_plantain ~ "surface cultivée en plantain (ha)",
                 rend_plantain ~ "rendement en plantin (kg/ha)"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


## 4.9. Palmier

Sur les `r nrow(loc)` exploitations enquêtées, `r nrow(pal)` cultivent le palmier


```{r tab18, tab.cap = "Production de palmier (les exploitations ne produisant pas de noix ou d'huile ne sont pas inclues dans les calculs de productions moyennes et de revenus moyens)"}

pal = merge(pal, loc[, c(1:2)])

pal$palmier_production = ifelse(pal$palmier_production == 0, NA, pal$palmier_production)
pal$palmier_revenus = ifelse(pal$palmier_revenus == 0, NA, pal$palmier_revenus)

pal[, c(2:14, 28:30, 34:36)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(plant_autoprod ~ "plants auto-produits",
                 plant_voisin ~ "plants provenant d'un voisin",
                 plant_magasin ~ "plants provenant d'un magasin",
                 plant_pepiniere ~ "plants provenant d'une pépinière",
                 plant_projet ~ "plants provenant d'une ONG/d'un projet",
                 plant_prive ~ "plants provenant d'un partenaire privé",
                 plant_publique ~ "plants provenant d'un partenaire publique",
                 age_max ~ "âge maximum des arbes",
                 age_min ~ "âge minimum des arbres",
                 part_autoconso ~ "part de produits du palmier autoconsommée (%)",
                 part_vendue ~ "part de produits du palmier vendue (%)",
                 noix ~ "vente des produits du palmier sous forme de noix",
                 huile ~ "vente des produits du palmier sous forme d'huile",
                 presse ~ "Utilisation d'une presse",
                 status_presse ~ "si utilisation d'une presse, status de cette presse",
                 cultivated_area ~ "surface cultivée en palmier (ha)",
                 palmier_production ~ "production totale de palmier (kg/an)",
                 palmier_revenus ~ "revenus totaux du palmier (XAF/an)"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


# 5. Elevage et pisciculture


```{r tab19, tab.cap = "Bétail possédé"}

bet = merge(bet, loc[, c(1:2)])

bet1 = bet

bet$bovins_pres = ifelse(bet$bovins > 0, 1, 0)
bet$porcs_pres = ifelse(bet$porcs > 0, 1, 0)
bet$petits_ruminants_pres = ifelse(bet$petits_ruminants > 0, 1, 0)
bet$volailles_pres = ifelse(bet$volailles > 0, 1, 0)

bet$bovins = ifelse(bet$bovins == 0, NA, bet$bovins)
bet$porcs = ifelse(bet$porcs == 0, NA, bet$porcs)
bet$petits_ruminants = ifelse(bet$petits_ruminants == 0, NA, bet$petits_ruminants)
bet$volailles = ifelse(bet$volailles == 0, NA, bet$volailles)

bet$alim_appoint_bovins[is.na(bet$alim_appoint_bovins)] = 0
bet$alim_appoint_porcs[is.na(bet$alim_appoint_porcs)] = 0
bet$alim_appoint_petits_ruminants[is.na(bet$alim_appoint_petits_ruminants)] = 0
bet$alim_appoint_volailles[is.na(bet$alim_appoint_volailles)] = 0

bet$alim = bet$alim_appoint_bovins + bet$alim_appoint_porcs + bet$alim_appoint_petits_ruminants +
  bet$alim_appoint_volailles

bet$alim = ifelse(bet$alim > 0, 1, 0)

bet = merge(bet, psn[, c(1:2)], by = "id")
bet$nb_etangs = ifelse(bet$nb_etangs > 0, 1, 0)

bet[, c(32:35, 2:5, 36:37, 31)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(bovins_pres ~ "Possession de bovins",
             porcs_pres ~ "Possession de porcs",
             petits_ruminants_pres ~ "Possession de petits ruminants",
             volailles_pres ~ "Possession de volailles",
             bovins ~ "Nb de bovins, pour les expl. en possédant",
             porcs ~ "Nb de porcs, pour les expl. en possédant",
             petits_ruminants ~ "Nb de petits ruminants, pour les expl. en possédant",
             volailles ~ "Nb de volailles, pour les expl. en possédant",
             alim ~ "Utilisation d'alimentation d'appoint pour le bétail",
             nb_etangs ~ "Possession d'un ou plisieurs étangs"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


```{r fig6, fig.width = 9, fig.height = 6, fig.cap = "Composition du cheptel (les exploitations ont été classées par taille de troupeau décroissante, et une moyenne moyenne mobile a été appliquée à des sous-ensembles de 10 exploitations pour lisser les courbes et faciliter leur interprétation. La ligne en pointillés représente la taille moyenne du foyer pour l'échantillon total. Pour une meilleure visibilité, l'axe des y a été plafonné à 5)"}

ubt = bet1[, c(1:5)]

ubt$bovins = 0.7 * ubt$bovins
ubt$porcs = 0.2 * ubt$porcs
ubt$petits_ruminants = 0.1 * ubt$petits_ruminants
ubt$volailles = 0.01 * ubt$volailles

names(ubt) = c("id", "Bovins", "Porcs", "Petits ruminants", "Volailles")

ubt$somme = rowSums(ubt[c(2:5)])
ubt = ubt[order(-ubt$somme),]
ubt$id2 = 1:nrow(ubt)

troupeau_moyen = mean(ubt$somme)

ubt$Bovins = frollmean(ubt$Bovins, 10)
ubt$Porcs = frollmean(ubt$Porcs, 10)
ubt$`Petits ruminants` = frollmean(ubt$`Petits ruminants`, 10)
ubt$Volailles = frollmean(ubt$Volailles, 10)

ubt = gather(ubt, espece, n, "Bovins":"Volailles")

ubt$espece = factor(ubt$espece, levels = c("Volailles", "Bovins", "Porcs", "Petits ruminants"))

ubt %>%
  ggplot(aes(x = id2, y = n, fill = as.factor(espece))) +
  geom_bar(stat = 'identity', width = 1, position = position_stack(reverse = TRUE)) +
  geom_hline(yintercept = troupeau_moyen, linetype = "dashed", color = "black", linewidth = 1) +
  coord_cartesian(ylim = c(0, 5)) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  scale_fill_manual(values = c("#225EA8", "#FFFFCC", "#A1DAB4", "#41B6C4")) +
  xlab("Exploitations") + ylab("Taille du cheptel (UBT)") + 
  theme_bw() +
  theme(plot.title = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 12,  face = "bold"),
        axis.title.x = element_text(size = 14, face = "bold", margin = margin(10, 0, 0, 0)),
        axis.title.y = element_text(size = 14, face = "bold", margin = margin(0, 10, 0, 0)),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(colour = "black", fill = "white"),
        legend.title = element_blank(),
        legend.text = element_text(size = 12),
        legend.position = c(0.9, 0.9), legend.justification = c(0.9, 0.9),
        plot.margin = margin(10, 10, 10, 10)) 

```


```{r tab20, tab.cap = "Dynamique du troupeau"}

bet[, c(6:10, 31)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(ubt ~ "Stock (UBT)",
                 betail_consomation ~ "Abattage pour consomation (UBT/an)",
                 betail_ventes ~ "Ventes (UBT/an)",
                 betail_mortalite ~ "Mortalité (UBT/an)",
                 betail_croit ~ "Entrées (naissances et achats, UBT/an"))%>%
  add_overall()%>%
  modify_header(label = "**Variable**")%>%
  as_kable()

```


# 6. Utilisation de ressources naturelles

```{r tab21, tab.cap = "Utilisation de ressources naturelles"}

res = merge(res, loc[, c(1:2)], by = "id")

res[, c(2, 4, 6, 18:28, 32)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1)%>%
  add_overall()%>%
  modify_header(label = "**Ressources utilisées**")%>%
  as_kable()

```


# 7. Revenus

```{r tab22, tab.cap = "Revenus"}

rvt$revenu_agricole = rvt$revenu_agricole + rvt$revenu_elevage + rvt$revenu_pisciculture
rvt$revenu_res_nat = rvt$revenu_peche + rvt$revenu_chasse + rvt$revenu_cueillette + rvt$revenu_orpaillage + rvt$revenu_exploitation_forestiere
rvt$autre = rvt$revenu_boutique + rvt$revenu_ouvrier + rvt$revenu_employe + rvt$revenu_cadre + rvt$revenu_autre
rvt$revenus_totaux = rvt$revenu_agricole + rvt$revenu_res_nat + rvt$autre

rvt = merge(rvt, loc[, c(1:2)], by = "id")

rvt[, c(2, 17, 15, 16, 19)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(revenu_agricole ~ "Revenus agricoles (XAF/an)",
             revenu_res_nat ~ "Revenus liés aux ressources naturelles (XAF/an)",
             revenu_autre ~ "Revenus autres (XAF/an)",
             revenus_totaux ~ "Revenus totaux (XAF/an)"))%>%
  add_overall()%>%
  modify_header(label = "**Source de revenus**")%>%
  as_kable()

```


# 8. Main d'oeuvre

```{r tab23, tab.cap = "Main d'oeuvre utilisée en agriculture"}

fct = merge(fct, loc[, c(1:2)], by = "id")

fct[, c(2:3, 9:15, 19)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(entraide ~ "Organisation en système d'entraide",
             main_doeuvre_ext ~ "Utilisation de main d'oeuvre extérieure",
             defriche ~ "Utilisation de main d'oeuve extérieure pour la défriche",
             preparation_terrain ~ "Utilisation de main d'oeuve extérieure pour la préparation du terrain",
             semis ~ "Utilisation de main d'oeuve extérieure pour le semis",
             sarclage ~ "Utilisation de main d'oeuve extérieure pour le sarclage",
             recolte ~ "Utilisation de main d'oeuve extérieure pour la récolte",
             transport ~ "Utilisation de main d'oeuve extérieure pour le transport",
             transformation ~ "Utilisation de main d'oeuve extérieure pour la transformation"))%>%
  add_overall()%>%
  modify_header(label = "**Variables**")%>%
  as_kable()

```


# 9. Dynamique

```{r tab24, tab.cap = "Dynamique"}

dyn = dyn[, c(1:2, 11)]
dyn = merge(dyn, psp, by = "id")
dyn = merge(dyn, loc[, c(1:2)], by = "id")

dyn[, c(2:5)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(evolution_surf_cult_passe ~ "Evolution des surfaces cultivées les 10 dernières années",
             evolution_surf_cult_future ~ "Project d'agrandir les surfaces cultivées les 5 prochaines années",
             reprise ~ "Pensez-vous que votre exploitation sera reprise?"))%>%
  add_overall()%>%
  modify_header(label = "**Variables**")%>%
  as_kable()

```


# 10. Equipements agricoles et de transport

```{r tab25, tab.cap = "Equipements utilisés"}

eqt = merge(eqt, loc[, c(1:2)], by = "id")

eqt[, c(2:7, 9:10, 20:24, 31)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(tracteur_usage ~ "Tracteur",
                 motoculteur_usage ~ "Motoculteur",
                 charrue_usage ~ "Charrue",
                 herse_usage ~ "Herse",
                 butteuse_usage ~ "Butteuse",
                 motopompe_usage ~ "Motopompe",
                 tronconneuse_usage ~ "Tronçonneuse",
                 pulverisateur_usage ~ "Pulverisateur",
                 voiture_usage ~ "Voiture",
                 kavaki_usage ~ "Kavaki",
                 moto_usage ~ "Moto",
                 brouette_usage ~ "Brouette",
                 velo_usage ~ "Vélo"))%>%
  add_overall()%>%
  modify_header(label = "**Equipement**")%>%
  as_kable()

```


```{r tab26, tab.cap = "Equipements en propriété"}

eqt[, c(11, 16:19, 25:29, 31)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
    label = list(tracteur_propriete ~ "Tracteur",
                 motopompe_propriete ~ "Motopompe",
                 batteuse_propriete ~ "Batteuse",
                 tronconneuse_propriete ~ "Tronçonneuse",
                 pulverisateur_propriete ~ "Pulverisateur",
                 voiture_propriete ~ "Voiture",
                 kavaki_propriete ~ "Kavaki",
                 moto_propriete ~ "Moto",
                 brouette_propriete ~ "Brouette",
                 velo_propriete ~ "Vélo"))%>%
  add_overall()%>%
  modify_header(label = "**Equipement**")%>%
  as_kable()

```


# 11. Environnement socio-economique

```{r tab27, tab.cap = "Groupements"}

acc = merge(acc, loc[, c(1:2)], by = "id")

acc[, c(2:13, 25)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(groupement ~ "Membre d'un groupement",
             le_groupement_a_t_il_un_agrement ~ "Groupement avec agrément",
             quelle_est_la_nature_du_groupement ~ "Nature du groupement",
             quel_est_lobjectif_du_groupement_acces_aux_intrants_petits_equipements ~ "Objectif: accès aux intrants et petits équipements",
             quel_est_lobjectif_du_groupement_acces_a_la_mecanisation ~ "Objectif: accès à la mécanisation",
             quel_est_lobjectif_du_groupement_entraide ~ "Objectif: entraide",
             quel_est_lobjectif_du_groupement_formations_et_partage_des_savoirs ~ "Objectif: formation et partage des savoirs",
             quel_est_lobjectif_du_groupement_transformation ~ "Objectif: transformation",
             quel_est_lobjectif_du_groupement_commercialisation ~ "Objectif: commercialisation",
             quel_est_lobjectif_du_groupement_beneficier_daides_de_projets ~ "Objectif: bénéficier d'aides de projets",
             quel_est_lobjectif_du_groupement_production_agricole ~ "Objectif: production agricole",
             quel_est_lobjectif_du_groupement_transport ~ "Objectif: transport"))%>%
  add_overall()%>%
  modify_header(label = "**Variables**")%>%
  as_kable()

```


```{r tab28, tab.cap = "Contrats"}

ctr = merge(ctr, loc[, c(1:2)], by = "id")

ctr[, c(2, 5, 7:8, 10:12, 16:28, 31:37, 39, 59)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(contrat ~ "Contrat avec acheteurs?",
             quel_s_production_s_sont_concernees_mais ~ "Contrat sur maïs",
             quel_s_production_s_sont_concernees_arachide ~ "Contrat sur arachide",
             quel_s_production_s_sont_concernees_cacao ~ "Contrat sur cacao",
             quel_s_production_s_sont_concernees_safou ~ "Contrat sur safou",
             quel_s_production_s_sont_concernees_plantain ~ "Contrat sur plantain",
             quel_s_production_s_sont_concernees_palmier ~ "Contrat sur palmier",
             quel_s_production_s_sont_concernees_cultures_maraicheres_aubergines_tomates_choux ~ "Contrat sur cultures maraichères",
             quel_s_production_s_sont_concernees_autre_annuelle_sesame ~ "Contrat sur autres annuelles (e.g., sesame)",
             quel_s_production_s_sont_concernees_autre_tubercule_igname_patate_douce ~ "Contrat sur autres turbercules",
             quel_s_production_s_sont_concernees_autre_fruitier ~ "Contrat sur autres fruitriers",
             quel_s_production_s_sont_concernees_viande_delevage ~ "Contrat sur viande d'élevage",
             quel_s_production_s_sont_concernees_viande_de_brousse ~ "Contrat sur viande de brousse",
             quel_s_production_s_sont_concernees_poisson ~ "Contrat sur poisson",
             quel_s_production_s_sont_concernees_produits_de_la_foret_chenilles_poivre_feuilles_ecorce ~ "Contrat sur produits de la forêt",
             quel_s_production_s_sont_concernees_manioc ~ "Contrat sur manioc",
             quel_s_production_s_sont_concernees_banane ~ "Contrat sur banane",
             quel_s_production_s_sont_concernees_pois_dangole ~ "Contrat sur pois d'angole",
             quel_s_production_s_sont_concernees_pasteque ~ "Contrat sur pastèque",
             quel_s_production_s_sont_concernees_ananas ~ "Contrat sur ananas",
             ce_contrat_est_il_formel_ou_informel ~ "Nature du contrat",
             sur_quoi_porte_cet_accord_le_prix ~ "Accord sur le prix",
             sur_quoi_porte_cet_accord_la_quantite ~ "Accord sur la quantité",
             sur_quoi_porte_cet_accord_la_qualite ~ "Accord sur la qualité",
             sur_quoi_porte_cet_accord_fourniture_dintrants_engrais_semences_produits_chimiques ~ "Accord sur la fourniture d'intrants",
             sur_quoi_porte_cet_accord_itineraire_technique ~ "Accord sur l'itinéraire technique",
             sur_quoi_porte_cet_accord_delai_de_paiement ~ "Accord sur le délai de paiement",
             sur_quoi_porte_cet_accord_credit ~ "Accord sur crédit"))%>%
  add_overall()%>%
  modify_header(label = "**Variables**")%>%
  as_kable()

```


```{r tab29, tab.cap = "Marchés"}

mch = merge(mch, loc[, c(1:2)], by = "id")

mch[, c(2:9)] %>%
  tbl_summary(
    by = departement,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{p}%"),
    missing = "no",
    digits = all_continuous() ~ 1,
label = list(ou_vendez_vous_vos_produits_village ~ "Vente au village",
             ou_vendez_vous_vos_produits_goudron ~ "Vente au goudron",
             ou_vendez_vous_vos_produits_chef_lieu_district_ou_departement ~ "Vente au chef lieu",
             ou_vendez_vous_vos_produits_brazzaville_pointe_noire ~ "Vente à Brazzaville ou Pointe-Noire",
             ou_vendez_vous_vos_produits_pas_de_vente ~ "Pas de vente",
             a_combien_de_kilometres_se_trouve_votre_point_de_vente_preferentiel ~ "Distance (km) point de vente préférentiel",
             avez_vous_ete_deja_constate_des_pertes_de_production_liees_au_transport ~ "Pertes de production liées au transport"))%>%
  add_overall()%>%
  modify_header(label = "**Variables**")%>%
  as_kable()

```







